{% extends "base.html" %}

{% block content %}
<div class="container split">

    <!-- FORM -->
    <div class="form-side">
        {% if editing %}
            <h1>Edit CV</h1>
        {% else %}
            <h1>Create Your CV</h1>
        {% endif %}

        <form id="cvForm" method="POST" action="{% if editing %}/cv/edit/{{ cv_id }}{% else %}/cv/save{% endif %}">
            
            <!-- اللغة -->
            <label>Language</label>
            <select name="language">
                <option value="en" {% if data.language == 'en' %}selected{% endif %}>English</option>
                <option value="fr" {% if data.language == 'fr' %}selected{% endif %}>Français</option>
                <option value="ar" {% if data.language == 'ar' %}selected{% endif %}>العربية</option>
            </select>

            <!-- القالب -->
            <label>Template</label>
            <select name="template">
                <option value="modern" {% if data.template == 'modern' %}selected{% endif %}>Modern</option>
                <option value="classic" {% if data.template == 'classic' %}selected{% endif %}>Classic</option>
                <option value="minimal" {% if data.template == 'minimal' %}selected{% endif %}>Minimal</option>
            </select>

            <hr>

            <label>Full Name</label>
            <input type="text" name="full_name" value="{{ data.full_name|default('') }}">

            <label>Job Title</label>
            <input type="text" name="job_title" value="{{ data.job_title|default('') }}">

            <label>Profile</label>
            <textarea name="profile">{{ data.profile|default('') }}</textarea>

            <label>Skills</label>
            <input type="text" name="skills" value="{{ data.skills|default('') }}">

            <!-- Experience -->
            <h2>Experience</h2>
            <div id="experienceList">
                {% for exp in data.experience %}
                    <input type="text" name="experience" value="{{ exp }}">
                {% endfor %}
            </div>
            <button type="button" onclick="addExperience()">+ Add Experience</button>

            <!-- Education -->
            <h2>Education</h2>
            <div id="educationList">
                {% for edu in data.education %}
                    <input type="text" name="education" value="{{ edu }}">
                {% endfor %}
            </div>
            <button type="button" onclick="addEducation()">+ Add Education</button>

            <!-- Projects -->
            <h2>Projects</h2>
            <div id="projectList">
                {% for proj in data.projects %}
                    <input type="text" name="projects" value="{{ proj }}">
                {% endfor %}
            </div>
            <button type="button" onclick="addProject()">+ Add Project</button>

            <hr>

            <label>
                <input type="checkbox" name="is_public" {% if data.is_public %}checked{% endif %}>
                Public CV (shareable link)
            </label>

            <button type="submit" class="btn save">Save & Get Link</button>
            <button type="button" onclick="exportPDF()" class="btn pdf">Export PDF</button>
        </form>
    </div>

    <!-- PREVIEW -->
    <div class="preview-side">
        <iframe id="previewFrame"></iframe>
    </div>

</div>

<script src="{{ url_for('static', filename='js/preview.js') }}"></script>
{% endblock %}
